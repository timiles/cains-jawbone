function normalizeWord(e){return e.normalize("NFKD").replace(/[^\w]/g,"").toLowerCase()}function extractWords(e,t){let n=0;t(n);const r=e.split("\n"),o=[];for(let e=0;e<r.length;e++){let s="";const l=r[e];let a=-1;for(let t=0;t<l.length;t++){const n=l[t];WORD_BREAK_CHARS.includes(n)?(s=normalizeWord(s),s&&(o.push({word:s,lineIndex:e,startCharIndex:a,endCharIndex:t}),s="",a=-1)):(-1===a&&(a=t),s+=n)}s=normalizeWord(s),s&&o.push({word:s,lineIndex:e,startCharIndex:a,endCharIndex:l.length});const d=Math.floor(100*(e+1)/r.length);d>n&&(n=d,t(n))}return o}const WORD_BREAK_CHARS=" â€”\t\r\n".split("");onmessage=({data:{text:e}})=>{const t=extractWords(e,(e=>postMessage({event:"onProgress",progressPercent:e})));postMessage({event:"onResult",result:t})};